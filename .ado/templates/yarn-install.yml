parameters:
- name: workingDirectory
  type: string
  default: .
- name: production
  type: boolean
  default: false
- name: frozenLockfile
  type: boolean
  default: true

steps:
  - script: |
      echo ##vso[task.setvariable variable=FrozenLockfileArgs]--frozen-lockfile
    displayName: Enable frozen-lockfile
    condition: ${{ parameters.frozenLockfile }}

  - task: CmdLine@2
    displayName: midgard-yarn (faster yarn install)
    inputs:
      script: npx midgard-yarn@1.23.14 --cwd ${{ parameters.workingDirectory }} --production=${{ parameters.production }} $(FrozenLockfileArgs) --network-concurrency 40 --cache-folder \.yarnCache
