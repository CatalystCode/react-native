<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!--
   For a standard project we determine all the correct directories assuming the folder layout is:

   app.json
        node_modules
            react-native-windows
            react-native

   However, if you are using yarn workspaces, their app.json may not be in a directory above react-native-windows, since the react-native-windows
   package may have been hoised to the root of the repo.  We also dont know if react-native was hoisted or not, and wouldn't be able to find it
   from the location of react-native-windows. In that case, the app will have to set an env variable to set ReactNativeProjectDir to allow us to 
   find their project root.  And from there we can load a react.override.props file which can specify the location of react-native and react-native-windows.
  -->
  <PropertyGroup>
    <ReactNativeProjectDir Condition="'$(ReactNativeProjectDir)' == ''">$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), app.json))</ReactNativeProjectDir>
  </PropertyGroup>

  <Import Project="$(ReactNativeProjectDir)\windows\react.overrides.props" Condition="Exists('$(ReactNativeProjectDir)\windows\react.overrides.props')" />

  <PropertyGroup>
    <!-- These are the default values if the app hasn't overridden them using env vars -->
    <ReactNativeWindowsDir Condition="'$(ReactNativeWindowsDir)' == ''">$([MSBuild]::NormalizeDirectory($(MSBuildThisFileDirectory)\..\))</ReactNativeWindowsDir>
    <ReactNativeDir Condition="'$(ReactNativeDir)' == ''">$(ReactNativeWindowsDir)node_modules\react-native</ReactNativeDir>
    <YogaDir Condition="'$(YogaDir)' == ''">$(ReactNativeDir)\ReactCommon\yoga</YogaDir>
  </PropertyGroup>

  <PropertyGroup Condition="!Exists('$(ReactNativeDir)\stubs\glog\logging.h')">
    <OSS_RN>true</OSS_RN>
    <FollyDir Condition="'$FollyDir' == ''">$(SolutionDir)node_modules\.folly\folly-2019.06.10.00</FollyDir>
  </PropertyGroup>

  <PropertyGroup Condition="Exists('$(ReactNativeDir)\stubs\glog\logging.h')">
    <FollyDir Condition="'$(FollyDir)' == ''">$(ReactNativeDir)\folly</FollyDir>
  </PropertyGroup>

</Project>

